
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Energy Balance Model &#8212; Earth System Modelling</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Ice albedo feedback in the 0D energy balance model" href="EBM_0D_ice_water.html" />
    <link rel="prev" title="Feedbacks in the climate" href="../content_feedback.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      <h1 class="site-logo" id="site-title">Earth System Modelling</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to the online Earth System Modelling / Atmospheric Physics book
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../content_physics.html">
   Climate Physics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="radeq.html">
     Radiative Equilibrium
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="rce.html">
     Radiative-Convective Equilibrium
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="orbital.html">
     Orbital variations, insolation, and the ice ages
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../content_feedback.html">
   Feedbacks in the climate
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Energy Balance Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="EBM_0D_ice_water.html">
     Ice albedo feedback in the 0D energy balance model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="daisy_world.html">
     Biogeophysical feedbacks: Daisy World
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/Energy_Balance_Model.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/adriantompkins/ICTP_DIPLOMA_LABS"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/adriantompkins/ICTP_DIPLOMA_LABS/issues/new?title=Issue%20on%20page%20%2Fnotebooks/Energy_Balance_Model.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/adriantompkins/ICTP_DIPLOMA_LABS/master?urlpath=tree/docs/notebooks/Energy_Balance_Model.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#top-of-atmosphere-eqn1">
     Top of Atmosphere (eqn1)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#surface-eqn2">
     Surface (eqn2)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#atmospheric-slab-eqn3">
     Atmospheric Slab (eqn3)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solving-the-slab-equations">
   Solving the slab equations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#questions">
   Questions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#two-slab-model">
   Two slab model
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="energy-balance-model">
<h1>Energy Balance Model<a class="headerlink" href="#energy-balance-model" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>In this notebook we are going to derive the greenhouse 1-slab energy balance model and play with emissivity of the slab to see the impact on the mean and atmospheric temperature.</p>
<p>If you recall from class, we treat the earth atmosphere system as <strong>black-body</strong> earth at temperature <span class="math notranslate nohighlight">\(T_s\)</span> with a grey atmospheric slab of temperature <span class="math notranslate nohighlight">\(T_a\)</span>:</p>
<p><img alt="atmos_radn_greenhouse.png" src="notebooks/attachment:atmos_radn_greenhouse.png" /></p>
<p>The key thing to remember is that emissivity is <strong>wavelength</strong> dependent.  Gases like water vapour and CO<span class="math notranslate nohighlight">\(_2\)</span> interact with radiation at various bands in the longwave (and also the short wave in the case of water vapour).  However, in this simple model we aggregate the radiation into two bands, one for the short wave and one for the long wave.</p>
<p>We neglect the small impact of water vapour and assume that in the short wave the atmosphere is transparent, while in the long wave the emissivity <span class="math notranslate nohighlight">\(\epsilon\)</span> is 0.6, that is, 60% of the infrared radiation is absorbed by the atmosphere.</p>
<p>We can now write the equations for the top of atmosphere, slab and surface:</p>
<p>At the top of the atmosphere, the incoming solar radiation <span class="math notranslate nohighlight">\(\frac{S_0}{4}(1-\alpha_p)\)</span> is balanced by black body emission from the Earth <span class="math notranslate nohighlight">\(\sigma T_s^4 \)</span>, of which <span class="math notranslate nohighlight">\(1-\epsilon\)</span> passes through the atmosphere (recall the Beer-Lambert Law) and also the emission from the atmosphere <span class="math notranslate nohighlight">\(\epsilon \sigma T_a^4\)</span>:</p>
<div class="section" id="top-of-atmosphere-eqn1">
<h3>Top of Atmosphere (eqn1)<a class="headerlink" href="#top-of-atmosphere-eqn1" title="Permalink to this headline">¶</a></h3>
<p>\begin{equation}
\frac{S_0}{4}(1-\alpha_p) = \sigma T_s^4 (1- \epsilon ) + \epsilon \sigma T_a^4
\label{eqn:ebmtoa}
\end{equation}</p>
<p>Assuming we can specify the solar constant <span class="math notranslate nohighlight">\(S_0\)</span>, the albedo <span class="math notranslate nohighlight">\(\alpha_p\)</span> and the atmospheric emissivity <span class="math notranslate nohighlight">\(\epsilon\)</span> as external parameters, this single equation has two unknowns <span class="math notranslate nohighlight">\(T_a\)</span> and <span class="math notranslate nohighlight">\(T_s\)</span>, the temperatures we are trying to find. So we also need a second equation for the balance at the surface:</p>
</div>
<div class="section" id="surface-eqn2">
<h3>Surface (eqn2)<a class="headerlink" href="#surface-eqn2" title="Permalink to this headline">¶</a></h3>
<p>\begin{equation}
\epsilon \sigma T_a^4 + \frac{S_0}{4}(1-\alpha_p) = \sigma T_s^4
\label{eqn:ebmsurf}
\end{equation}</p>
<p>See if you can derive this (refer to the class notes).</p>
<p>Actually, we can also write a third equation for the balance of the slab itself, this overspecifies the problem as we only need 2 of the 3 equations to solve for <span class="math notranslate nohighlight">\(T_a\)</span> and <span class="math notranslate nohighlight">\(T_s\)</span>, but the resulting equation is nice and simple due to the fact that the atmosphere is transparent to solar radiation, thus we simply balance absorption with emission:</p>
</div>
<div class="section" id="atmospheric-slab-eqn3">
<h3>Atmospheric Slab (eqn3)<a class="headerlink" href="#atmospheric-slab-eqn3" title="Permalink to this headline">¶</a></h3>
<p>\begin{equation}
\epsilon \sigma T_s^4 = 2 \epsilon \sigma T_a^4
\label{eqn:ebmatmos}
\end{equation}</p>
<p>Note the factor 2 on the right hand side, this is important!  We recall that the radiance in Stefan-Boltzmann’s Law is integrated over the solid angle for a <strong>hemisphere</strong>.  The atmosphere doesn’t just emit outwards to space, but also in the downward direction back towards Earth, thus over <strong>2</strong> hemispheres! (Otherwise the atmosphere temperature would equal that of the surface, think about it!)</p>
<p>Ok, got that?  So let’s play with a simple model…</p>
</div>
</div>
<div class="section" id="solving-the-slab-equations">
<h2>Solving the slab equations<a class="headerlink" href="#solving-the-slab-equations" title="Permalink to this headline">¶</a></h2>
<p>From eqn 3 above we see that</p>
<p>\begin{equation}
T_a = \frac{T_s}{\sqrt[4]{2}}
\end{equation}</p>
<p>which can be substituted into either (1) or (2) [exercise show] to give:</p>
<p>\begin{equation}
T_s = \sqrt[4]{\frac{S_0(1-\alpha_p)}{2 \sigma (2-\epsilon)}}
\end{equation}</p>
<p>Let’s look at this with a simple python code…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># define the external parameters</span>
<span class="n">eps</span><span class="o">=</span><span class="mf">0.8</span>   <span class="c1"># atmospheric emissivity in infrared</span>
<span class="n">alb</span><span class="o">=</span><span class="mf">0.3</span>   <span class="c1"># albedo</span>
<span class="n">S0</span><span class="o">=</span><span class="mi">1370</span>   <span class="c1"># solar constant W/m2</span>
<span class="n">sigma</span><span class="o">=</span><span class="mf">5.67e-8</span> <span class="c1"># SB constant</span>

<span class="c1"># surface temperature</span>
<span class="n">eqn</span><span class="o">=</span><span class="n">S0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">eps</span><span class="p">))</span>
<span class="n">Ts</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">eqn</span><span class="p">,</span><span class="mf">0.25</span><span class="p">)</span>

<span class="c1"># atmospheric temperature</span>
<span class="n">Ta</span><span class="o">=</span><span class="n">Ts</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.25</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Surface Temperature=&quot;</span><span class="p">,</span><span class="n">Ts</span><span class="p">,</span><span class="s2">&quot; Kelvin&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Atmos Temperature=&quot;</span><span class="p">,</span><span class="n">Ta</span><span class="p">,</span><span class="s2">&quot; Kelvin&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Surface Temperature= 289.7384127570699  Kelvin
Atmos Temperature= 243.6399926487212  Kelvin
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="questions">
<h2>Questions<a class="headerlink" href="#questions" title="Permalink to this headline">¶</a></h2>
<p>what happens when you set <span class="math notranslate nohighlight">\(\epsilon\)</span>=0 ?  What is the atmospheric temperature in this case? Does it make sense (refer to equation 3 above!)</p>
<p>now we make graph of temperature as a function of <span class="math notranslate nohighlight">\(\epsilon\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">calcT</span><span class="p">(</span><span class="n">alb</span><span class="p">,</span><span class="n">eps</span><span class="p">):</span>
    <span class="c1"># surface temperature</span>
    <span class="n">eqn</span><span class="o">=</span><span class="n">S0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sigma</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">eps</span><span class="p">))</span>
    <span class="n">Ts</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">eqn</span><span class="p">,</span><span class="mf">0.25</span><span class="p">)</span>

    <span class="c1"># atmospheric temperature</span>
    <span class="n">Ta</span><span class="o">=</span><span class="n">Ts</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mf">0.25</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">Ts</span><span class="p">,</span><span class="n">Ta</span><span class="p">)</span>
    
<span class="c1"># define the external parameters</span>
<span class="n">S0</span><span class="o">=</span><span class="mi">1370</span>   <span class="c1"># solar constant W/m2</span>
<span class="n">sigma</span><span class="o">=</span><span class="mf">5.67e-8</span> <span class="c1"># SB constant</span>
<span class="n">alb0</span><span class="o">=</span><span class="mf">0.3</span> <span class="c1"># default value when other param is varied</span>
<span class="n">eps0</span><span class="o">=</span><span class="mf">0.6</span> <span class="c1"># default value when other param is varied</span>

<span class="k">global</span> <span class="n">S0</span><span class="p">,</span><span class="n">sigma</span> 

<span class="c1"># let&#39;s make emissivity an array</span>
<span class="n">leps</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.05</span><span class="p">)</span> <span class="c1"># min,max,inc</span>
<span class="n">lalb</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.05</span><span class="p">)</span> 

<span class="c1"># loop over emissivity</span>
<span class="n">Tse</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">leps</span><span class="p">))</span>
<span class="n">Tae</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">leps</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">eps</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">leps</span><span class="p">):</span>
    <span class="n">Tse</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">Tae</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">calcT</span><span class="p">(</span><span class="n">alb0</span><span class="p">,</span><span class="n">eps</span><span class="p">)</span>
    
<span class="c1"># loop over albedo </span>
<span class="n">Tsa</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lalb</span><span class="p">))</span>
<span class="n">Taa</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lalb</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">alb</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lalb</span><span class="p">):</span>
    <span class="n">Tsa</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">Taa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">calcT</span><span class="p">(</span><span class="n">alb</span><span class="p">,</span><span class="n">eps0</span><span class="p">)</span>
 
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">leps</span><span class="p">,</span><span class="n">Tse</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">leps</span><span class="p">,</span><span class="n">Tae</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Emissivity&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Surface Temperature (K)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Ts&#39;</span><span class="p">,</span><span class="s1">&#39;Ta&#39;</span><span class="p">])</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lalb</span><span class="p">,</span><span class="n">Tsa</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Albedo&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lalb</span><span class="p">,</span><span class="n">Taa</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Ts&#39;</span><span class="p">,</span><span class="s1">&#39;Ta&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x13be59b50&gt;
</pre></div>
</div>
<img alt="../_images/Energy_Balance_Model_4_1.png" src="../_images/Energy_Balance_Model_4_1.png" />
</div>
</div>
</div>
<div class="section" id="two-slab-model">
<h2>Two slab model<a class="headerlink" href="#two-slab-model" title="Permalink to this headline">¶</a></h2>
<p>troposphere and stratosphere, coming soon to a notebook near you!</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="../content_feedback.html" title="previous page">Feedbacks in the climate</a>
    <a class='right-next' id="next-link" href="EBM_0D_ice_water.html" title="next page">Ice albedo feedback in the 0D energy balance model</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Adrian Tompkins<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  None
  </body>
</html>